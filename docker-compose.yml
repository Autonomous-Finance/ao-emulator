version: '3.8'

services:
  # Agent Factory Process
  aos-agent-factory:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=x_WysdFwKD_buywRK9qLA7IexdlsvVTVq6ESWMRCzFY
      - PORT=3001
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Permaweb Index Process
  aos-permaweb-index:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=rxxU4g-7tUHGvF28W2l53hxarpbaFR4NaSnOaxx6MIE
      - PORT=3002
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Dexi Process
  aos-dexi:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=Meb6GwY5I9QN77F0c5Ku2GpCFxtYyG1mfJus2GWYtII
      - PORT=3003
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network
    deploy:
      replicas: 4

  # Token Locker Process
  aos-token-locker:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=jxiKuu_21_KjNga8KxH1h8fJeoCl9DzcEjGBiKN66DY
      - PORT=3005
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Permaweb Index Token Process
  aos-permaweb-index-token:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=4hXj_E-5fAKmo4E8KjgQvuDJKAFk9P2grhycVmISDLs
      - PORT=3006
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Registry Process
  aos-registry:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=iZuNCnURIQHazG9cIui2B5FdQzWRE8TMa28i6nHr5ic
      - PORT=3007
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Token Factory Process
  aos-token-factory:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=mQES2_hwlXQS8JVSdPJvRTkp78slLCl2gpm6sW3CK9w
      - PORT=3010
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Portfolio Agent Factory Process
  aos-portfolio-agent-factory:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=OF3TuQgd3RkTb9HSs_V94vVPFeRXi1h0EGJhSgda7OI
      - PORT=3011
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # FLP Factory Process
  aos-flp-factory:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=It-_AKlEfARBmJdbJew1nG9_hIaZt0t20wQc28mFGBE
      - PORT=3012
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # AMM Factory Process
  aos-amm-factory:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=3XBGLrygs11K63F_7mldWz4veNx6Llg6hI2yZs8LKHo
      - PORT=3013
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Payment Token Process
  aos-payment-token:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=atlyT9ph8ex_TxDDkQ2fdbhVT62sLw6boJPdEr7UqJE
      - PORT=3014
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # AO Process
  aos-ao:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=0syT13r0s0tgPmIed95bJnuSqaD29HQNN8D3ElLSrsc
      - PORT=3016
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network
    deploy:
      replicas: 4

  # Delegation Oracle Process
  aos-delegation-oracle:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=cuxSKjGJ-WDB9PzSkVkVVrIBSh3DrYHYz44usQOj5yE
      - PORT=3017
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network
    deploy:
      replicas: 2

  # Delegation Historian Process
  aos-delegation-historian:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=NRP0xtzeV9MHgwLmgD254erUB7mUjMBhBkYkNYkbNEo
      - PORT=3018
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network
    deploy:
      replicas: 2

  # QAR Process
  aos-qar:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=NG-0lVX882MG5nhARrSzyprEK6ejonHpdUmaaMPsHE8
      - PORT=3019
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network

  # Wrapped AR Process
  aos-wrapped-ar:
    build: .
    environment:
      - PROCESS_ID_TO_MONITOR=xU9zFkq3X2ZQ6olwNVvr1vUWIjc3kXTWr7xKQD6dh10
      - PORT=3020
      - SU_URL=https://su-router.ao-testnet.xyz
      - MESSAGE_POLLING_INTERVAL=10s
    networks:
      - aos-network
    deploy:
      replicas: 2

  nginx:
    image: nginx:alpine
    ports:
      - "8080:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
    depends_on:
      - aos-agent-factory
      - aos-permaweb-index
      - aos-dexi
      - aos-token-locker
      - aos-permaweb-index-token
      - aos-registry
      - aos-token-factory
      - aos-portfolio-agent-factory
      - aos-flp-factory
      - aos-amm-factory
      - aos-payment-token
      - aos-ao
      - aos-delegation-oracle
      - aos-delegation-historian
      - aos-qar
      - aos-wrapped-ar
      - aos-redstone-proxy
    networks:
      - aos-network

networks:
  aos-network:
    driver: bridge
